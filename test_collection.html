<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯• - æ•°æ®é‡‡é›†</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
        }

        .section-card {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .section-header {
            background: #ecfdf5;
            padding: 15px 20px;
            font-weight: 600;
            color: #065f46;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
        }

        .section-content {
            padding: 20px;
        }

        .indicator-item {
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #d1d5db;
        }

        .indicator-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        input[type="range"] {
            width: 100%;
        }

        button {
            background: #10b981;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background: #059669;
        }

        .debug {
            background: #1f2937;
            color: #10b981;
            padding: 10px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸŒ± æ•°æ®é‡‡é›†æµ‹è¯•é¡µé¢</h1>
        <p>è¿™æ˜¯ä¸€ä¸ªç®€åŒ–çš„æµ‹è¯•é¡µé¢ï¼Œç”¨äºéªŒè¯æ•°æ®é‡‡é›†åŠŸèƒ½ã€‚</p>

        <div id="statusDiv" style="background: #fef3c7; padding: 10px; border-radius: 8px; margin-bottom: 20px;">
            çŠ¶æ€ï¼šæ­£åœ¨åˆå§‹åŒ–...
        </div>

        <div id="weeklySection" class="section-card">
            <div class="section-header">ğŸ“Š æ¯å‘¨æ•°æ® (Weekly Data)</div>
            <div id="weeklyContent" class="section-content"></div>
        </div>

        <div id="dailySection" class="section-card">
            <div class="section-header">ğŸ“… æ¯æ—¥æ•°æ® (Daily Data)</div>
            <div id="dailyContent" class="section-content"></div>
        </div>

        <button onclick="saveData()">ğŸ’¾ ä¿å­˜æ•°æ®</button>

        <div class="debug" id="debugLog"></div>
    </div>

    <script>
        const debugLog = document.getElementById('debugLog');
        const statusDiv = document.getElementById('statusDiv');

        function log(msg) {
            console.log(msg);
            debugLog.innerHTML += `<div>${new Date().toLocaleTimeString()}: ${msg}</div>`;
            debugLog.scrollTop = debugLog.scrollHeight;
        }

        function updateStatus(msg, color = '#fef3c7') {
            statusDiv.innerHTML = msg;
            statusDiv.style.background = color;
        }

        // ç®€åŒ–çš„æŒ‡æ ‡é…ç½®
        const testIndicators = [
            // æ¯å‘¨æŒ‡æ ‡
            { field: 'growth_cm', name: 'æ ªé«˜', unit: 'cm', min: 0, max: 100, step: 0.1, defaultValue: 10, frequency: 'weekly' },
            { field: 'stem_mm', name: 'èŒç²—', unit: 'mm', min: 0, max: 30, step: 0.1, defaultValue: 5, frequency: 'weekly' },
            { field: 'leaf_count', name: 'å¶ç‰‡æ•°', unit: 'ä¸ª', min: 0, max: 25, step: 1, defaultValue: 5, frequency: 'weekly' },

            // æ¯æ—¥æŒ‡æ ‡  
            { field: 'irrigation_ml', name: 'çŒæº‰é‡', unit: 'ml', min: 0, max: 3000, step: 10, defaultValue: 0, frequency: 'daily' },
            { field: 'daily_yield_kg', name: 'æ—¥äº§é‡', unit: 'kg', min: 0, max: 30, step: 0.01, defaultValue: 0, frequency: 'daily' },
            { field: 'harvest_ear_count', name: 'é‡‡æ”¶æœç©—æ•°', unit: 'ä¸ª', min: 0, max: 60, step: 1, defaultValue: 0, frequency: 'daily' }
        ];

        const collectedData = {};

        function renderIndicator(ind, container) {
            const item = document.createElement('div');
            item.className = 'indicator-item';
            item.innerHTML = `
                <div class="indicator-label">
                    <span><strong>${ind.name}</strong> (${ind.unit})</span>
                    <span id="value-${ind.field}">${ind.defaultValue}</span>
                </div>
                <input type="range" 
                       id="slider-${ind.field}"
                       min="${ind.min}" 
                       max="${ind.max}" 
                       step="${ind.step}" 
                       value="${ind.defaultValue}"
                       oninput="updateValue('${ind.field}', this.value)">
            `;
            container.appendChild(item);
            collectedData[ind.field] = ind.defaultValue;
        }

        function updateValue(field, value) {
            document.getElementById(`value-${field}`).textContent = value;
            collectedData[field] = parseFloat(value);
            log(`å·²æ›´æ–° ${field} = ${value}`);
        }

        function saveData() {
            log('ä¿å­˜æ•°æ®: ' + JSON.stringify(collectedData, null, 2));
            updateStatus('âœ… æ•°æ®å·²ä¿å­˜ï¼ˆä»…ä¿å­˜åˆ°å†…å­˜ç”¨äºæµ‹è¯•ï¼‰', '#d1fae5');
            alert('æ•°æ®å·²ä¿å­˜ï¼\n' + JSON.stringify(collectedData, null, 2));
        }

        // åˆå§‹åŒ–
        function init() {
            try {
                log('å¼€å§‹åˆå§‹åŒ–æµ‹è¯•é¡µé¢...');

                const weeklyContent = document.getElementById('weeklyContent');
                const dailyContent = document.getElementById('dailyContent');

                const weeklyInds = testIndicators.filter(ind => ind.frequency === 'weekly');
                const dailyInds = testIndicators.filter(ind => ind.frequency === 'daily');

                log(`æ‰¾åˆ° ${weeklyInds.length} ä¸ªæ¯å‘¨æŒ‡æ ‡`);
                log(`æ‰¾åˆ° ${dailyInds.length} ä¸ªæ¯æ—¥æŒ‡æ ‡`);

                weeklyInds.forEach(ind => renderIndicator(ind, weeklyContent));
                dailyInds.forEach(ind => renderIndicator(ind, dailyContent));

                updateStatus(`âœ… åˆå§‹åŒ–å®Œæˆï¼å…± ${testIndicators.length} ä¸ªæŒ‡æ ‡`, '#d1fae5');
                log('åˆå§‹åŒ–å®Œæˆï¼');
            } catch (e) {
                log('é”™è¯¯: ' + e.message);
                updateStatus('âŒ åˆå§‹åŒ–å¤±è´¥: ' + e.message, '#fee2e2');
            }
        }

        // é¡µé¢åŠ è½½åç«‹å³åˆå§‹åŒ–
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>

</html>