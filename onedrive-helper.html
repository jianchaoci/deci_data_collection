<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ OneDrive éƒ¨ç½²åŠ©æ‰‹</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #e8f5e8 0%, #f0fdf4 100%);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .step-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .step-title {
            color: #15803d;
            border-bottom: 2px solid #bbf7d0;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        .info-box {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid;
        }
        
        .info-box.success { background: #f0fdf4; border-color: #22c55e; }
        .info-box.warning { background: #fefce8; border-color: #eab308; }
        .info-box.info { background: #eff6ff; border-color: #3b82f6; }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background: #22c55e;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin: 5px;
            border: none;
            cursor: pointer;
        }
        
        .btn:hover { background: #16a34a; }
        
        input[type="text"], textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
        }
        
        .copy-btn {
            background: #6b7280;
            font-size: 12px;
            padding: 5px 10px;
        }
        
        .result-box {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸŒ OneDrive éƒ¨ç½²åŠ©æ‰‹</h1>
        <p>å¸®åŠ©æ‚¨å°†æ¤ç‰©è¡¨å‹é‡‡é›†ç³»ç»Ÿéƒ¨ç½²åˆ° OneDrive</p>
    </div>

    <div class="step-section">
        <h2 class="step-title">ğŸ“‹ æ­¥éª¤ 1ï¼šä¸Šä¼ æ–‡ä»¶åˆ° OneDrive</h2>
        
        <div class="info-box info">
            <strong>éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼š</strong><br>
            â€¢ index.htmlï¼ˆä¸»åº”ç”¨æ–‡ä»¶ï¼‰<br>
            â€¢ å…¶ä»–ç›¸å…³ HTML/CSS/JS æ–‡ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰
        </div>
        
        <p><strong>æ“ä½œæ­¥éª¤ï¼š</strong></p>
        <ol>
            <li>è®¿é—® <a href="https://onedrive.com" target="_blank">OneDrive.com</a></li>
            <li>ç™»å½•æ‚¨çš„ Microsoft è´¦æˆ·</li>
            <li>åˆ›å»ºæ–°æ–‡ä»¶å¤¹ï¼ˆå»ºè®®å‘½åï¼šplant-data-collectionï¼‰</li>
            <li>ä¸Šä¼  index.html æ–‡ä»¶åˆ°è¯¥æ–‡ä»¶å¤¹</li>
            <li>ç¡®ä¿æ–‡ä»¶åæ­£ç¡®ï¼ˆå¿…é¡»æ˜¯ index.htmlï¼‰</li>
        </ol>
        
        <a href="https://onedrive.com" class="btn" target="_blank">ğŸš€ æ‰“å¼€ OneDrive</a>
    </div>

    <div class="step-section">
        <h2 class="step-title">ğŸ”— æ­¥éª¤ 2ï¼šè·å–åˆ†äº«é“¾æ¥</h2>
        
        <p><strong>æ“ä½œæ­¥éª¤ï¼š</strong></p>
        <ol>
            <li>åœ¨ OneDrive ä¸­å³é”®ç‚¹å‡»æ‚¨çš„æ–‡ä»¶å¤¹</li>
            <li>é€‰æ‹©"åˆ†äº«" â†’ "å¤åˆ¶é“¾æ¥"</li>
            <li>è®¾ç½®æƒé™ä¸º"å…·æœ‰é“¾æ¥çš„ä»»ä½•äººéƒ½å¯æŸ¥çœ‹"</li>
            <li>å°†è·å¾—çš„é“¾æ¥ç²˜è´´åˆ°ä¸‹é¢çš„è¾“å…¥æ¡†ä¸­</li>
        </ol>
        
        <p><strong>ç²˜è´´æ‚¨ä» OneDrive è·å¾—çš„åˆ†äº«é“¾æ¥ï¼š</strong></p>
        <input type="text" id="shareLink" placeholder="ç²˜è´´ OneDrive åˆ†äº«é“¾æ¥..." 
               oninput="convertLink()">
        
        <div id="convertResult" style="display: none;">
            <h3>ğŸ¯ è½¬æ¢ç»“æœ</h3>
            <p><strong>æ£€æµ‹åˆ°çš„é“¾æ¥ç±»å‹ï¼š</strong> <span id="linkType"></span></p>
            <p><strong>å»ºè®®çš„é‡å®šå‘ URIï¼š</strong></p>
            <div class="result-box">
                <span id="redirectUri"></span>
                <button class="copy-btn" onclick="copyToClipboard('redirectUri')">å¤åˆ¶</button>
            </div>
        </div>
    </div>

    <div class="step-section">
        <h2 class="step-title">âš™ï¸ æ­¥éª¤ 3ï¼šé…ç½® Dropbox é‡å®šå‘ URI</h2>
        
        <div class="info-box warning">
            <strong>é‡è¦ï¼š</strong>å¿…é¡»åœ¨ Dropbox åº”ç”¨ä¸­é…ç½®é‡å®šå‘ URIï¼Œå¦åˆ™ OAuth è®¤è¯ä¼šå¤±è´¥ã€‚
        </div>
        
        <p><strong>é…ç½®æ­¥éª¤ï¼š</strong></p>
        <ol>
            <li>è®¿é—® <a href="https://www.dropbox.com/developers/apps" target="_blank">Dropbox å¼€å‘è€…æ§åˆ¶å°</a></li>
            <li>æ‰¾åˆ°æ‚¨çš„åº”ç”¨ï¼ˆAPP Key: j38wp0xvibd9bjqï¼‰</li>
            <li>è¿›å…¥ "Settings" â†’ "OAuth 2" â†’ "Redirect URIs"</li>
            <li>ç‚¹å‡» "Add" æ·»åŠ ä¸Šé¢ç”Ÿæˆçš„é‡å®šå‘ URI</li>
            <li>ä¿å­˜é…ç½®</li>
        </ol>
        
        <a href="https://www.dropbox.com/developers/apps" class="btn" target="_blank">ğŸ”§ æ‰“å¼€ Dropbox æ§åˆ¶å°</a>
    </div>

    <div class="step-section">
        <h2 class="step-title">âœ… æ­¥éª¤ 4ï¼šæµ‹è¯•éƒ¨ç½²</h2>
        
        <p><strong>æµ‹è¯•æ¸…å•ï¼š</strong></p>
        <div id="testSection">
            <p>è¯·å…ˆå®Œæˆä¸Šè¿°æ­¥éª¤ï¼Œç„¶åç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®è¿›è¡Œæµ‹è¯•ï¼š</p>
            <button class="btn" onclick="testDeployment()" id="testBtn" disabled>ğŸ§ª æµ‹è¯• OneDrive éƒ¨ç½²</button>
        </div>
        
        <div id="testResults" style="display: none;"></div>
    </div>

    <div class="step-section">
        <h2 class="step-title">ğŸ“Š éƒ¨ç½²å¯¹æ¯”</h2>
        
        <div class="info-box success">
            <strong>âœ… æ‚¨çš„ GitHub Pagesï¼š</strong><br>
            <code>https://jianchaoci.github.io/deci_data_collection/</code><br>
            <small>ä¸»è¦éƒ¨ç½²ï¼Œæ¨èç”¨äºæ­£å¼ä½¿ç”¨</small>
        </div>
        
        <div class="info-box info">
            <strong>ğŸ†• OneDrive éƒ¨ç½²ï¼š</strong><br>
            <span id="onedriveUrl">å®Œæˆä¸Šè¿°æ­¥éª¤åå°†æ˜¾ç¤º</span><br>
            <small>å¤‡ç”¨éƒ¨ç½²ï¼Œé€‚åˆå†…éƒ¨æµ‹è¯•</small>
        </div>
        
        <div class="info-box warning">
            <strong>ğŸ’¡ å»ºè®®é…ç½®ä¸¤ä¸ªé‡å®šå‘ URIï¼š</strong><br>
            è¿™æ ·æ‚¨å¯ä»¥çµæ´»åˆ‡æ¢ä½¿ç”¨ GitHub Pages æˆ– OneDrive ç‰ˆæœ¬
        </div>
    </div>

    <script>
        function convertLink() {
            const shareLink = document.getElementById('shareLink').value.trim();
            const resultDiv = document.getElementById('convertResult');
            const linkTypeSpan = document.getElementById('linkType');
            const redirectUriSpan = document.getElementById('redirectUri');
            const onedriveUrlSpan = document.getElementById('onedriveUrl');
            const testBtn = document.getElementById('testBtn');
            
            if (!shareLink) {
                resultDiv.style.display = 'none';
                testBtn.disabled = true;
                return;
            }
            
            let convertedUri = '';
            let linkType = '';
            
            try {
                if (shareLink.includes('1drv.ms')) {
                    linkType = 'çŸ­é“¾æ¥ (1drv.ms)';
                    convertedUri = shareLink; // å¯èƒ½éœ€è¦è¿›ä¸€æ­¥è½¬æ¢
                } else if (shareLink.includes('onedrive.live.com')) {
                    linkType = 'OneDrive Live é“¾æ¥';
                    
                    // å°è¯•æå–å‚æ•°
                    const url = new URL(shareLink);
                    const resid = url.searchParams.get('resid') || url.searchParams.get('id');
                    const authkey = url.searchParams.get('authkey');
                    
                    if (resid) {
                        // æ„é€ åµŒå…¥é“¾æ¥
                        convertedUri = `https://onedrive.live.com/embed?resid=${resid}`;
                        if (authkey) {
                            convertedUri += `&authkey=${authkey}`;
                        }
                        convertedUri += '&em=2&wdStartOn=1';
                    } else {
                        convertedUri = shareLink + (shareLink.includes('?') ? '&' : '?') + 'em=2';
                    }
                } else if (shareLink.includes('sharepoint.com')) {
                    linkType = 'SharePoint é“¾æ¥';
                    convertedUri = shareLink; // SharePoint é“¾æ¥é€šå¸¸å¯ä»¥ç›´æ¥ä½¿ç”¨
                } else {
                    linkType = 'æœªçŸ¥æ ¼å¼';
                    convertedUri = shareLink;
                }
                
                redirectUriSpan.textContent = convertedUri;
                linkTypeSpan.textContent = linkType;
                onedriveUrlSpan.innerHTML = `<code>${convertedUri}</code>`;
                resultDiv.style.display = 'block';
                testBtn.disabled = false;
                
            } catch (error) {
                linkType = 'é“¾æ¥æ ¼å¼é”™è¯¯';
                convertedUri = 'è¯·æ£€æŸ¥é“¾æ¥æ ¼å¼';
                redirectUriSpan.textContent = convertedUri;
                linkTypeSpan.textContent = linkType;
                resultDiv.style.display = 'block';
                testBtn.disabled = true;
            }
        }
        
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = 'å·²å¤åˆ¶!';
                button.style.background = '#059669';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#6b7280';
                }, 2000);
            }).catch(() => {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
            });
        }
        
        function testDeployment() {
            const redirectUri = document.getElementById('redirectUri').textContent;
            const testResults = document.getElementById('testResults');
            
            testResults.innerHTML = `
                <h3>ğŸ§ª æµ‹è¯•ç»“æœ</h3>
                <div class="info-box info">
                    <strong>æ­£åœ¨æµ‹è¯•è®¿é—®...</strong><br>
                    å°è¯•è®¿é—®ï¼š<code>${redirectUri}</code>
                </div>
                <p><a href="${redirectUri}" target="_blank" class="btn">ğŸš€ åœ¨æ–°çª—å£ä¸­æ‰“å¼€æµ‹è¯•</a></p>
                <div class="info-box warning">
                    <strong>æµ‹è¯•è¦ç‚¹ï¼š</strong><br>
                    âœ“ é¡µé¢æ˜¯å¦æ­£å¸¸åŠ è½½<br>
                    âœ“ æ ·å¼æ˜¯å¦æ˜¾ç¤ºæ­£ç¡®<br>
                    âœ“ è¡¨å•åŠŸèƒ½æ˜¯å¦æ­£å¸¸<br>
                    âœ“ æ˜¯å¦èƒ½è¿æ¥åˆ° Dropbox
                </div>
            `;
            testResults.style.display = 'block';
        }
    </script>
</body>
</html>